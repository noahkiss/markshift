---
phase: 10-github-pages-web-ui
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified:
  - src/web/index.html
  - src/web/main.ts
  - src/web/style.css
  - .github/workflows/deploy-pages.yml
autonomous: false

must_haves:
  truths:
    - "User can access web UI at GitHub Pages URL"
    - "User can paste HTML and receive Markdown"
    - "User can paste Markdown and receive HTML"
    - "Content extraction option cleans web page HTML"
    - "Copy button copies output to clipboard"
  artifacts:
    - path: "src/web/index.html"
      provides: "Web UI entry point"
      contains: "converter-form"
    - path: "src/web/main.ts"
      provides: "UI logic and event handlers"
      contains: "addEventListener"
    - path: "src/web/style.css"
      provides: "UI styling"
      min_lines: 30
    - path: ".github/workflows/deploy-pages.yml"
      provides: "GitHub Actions deployment workflow"
      contains: "deploy-pages"
  key_links:
    - from: "src/web/main.ts"
      to: "src/web/browser-converters.ts"
      via: "import"
      pattern: "import.*browser-converters"
    - from: "src/web/index.html"
      to: "src/web/main.ts"
      via: "script module"
      pattern: "type=\"module\".*main.ts"
    - from: ".github/workflows/deploy-pages.yml"
      to: "docs/"
      via: "upload artifact"
      pattern: "path: docs"
---

<objective>
Create the web UI and GitHub Actions deployment workflow for the markshift web converter.

Purpose: Provide a browser-based interface where users can convert HTML to Markdown (and vice versa) without installing the CLI. This makes the tool accessible to anyone with a web browser.

Output: Complete web UI with conversion forms, copy functionality, content extraction option, and automated GitHub Pages deployment
</objective>

<execution_context>
@/home/flight/.claude/get-shit-done/workflows/execute-plan.md
@/home/flight/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-github-pages-web-ui/10-RESEARCH.md

# Browser converters from Plan 01
@src/web/browser-converters.ts
@vite.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create web UI HTML and styling</name>
  <files>src/web/index.html, src/web/style.css</files>
  <action>
Create `src/web/index.html` with:
- DOCTYPE, meta charset UTF-8, viewport meta for mobile
- Title: "markshift - HTML/Markdown Converter"
- Link to style.css
- Main content:
  - h1 heading "markshift"
  - Brief description: "Convert between HTML and Markdown in your browser"
  - Form with id="converter-form":
    - Input textarea (id="input", rows=12, placeholder="Paste HTML or Markdown here...")
    - Controls div:
      - Mode select (id="mode"): "HTML to Markdown" (value="html-to-md"), "Markdown to HTML" (value="md-to-html")
      - Extract content checkbox (id="extract-content") with label "Extract main content (clean web pages)"
      - Convert button (type="submit")
    - Output textarea (id="output", rows=12, readonly, placeholder="Converted output will appear here...")
    - Copy button (type="button", id="copy-btn") with text "Copy to Clipboard"
  - Footer with link to GitHub repo
- Script tag type="module" src="./main.ts"

Create `src/web/style.css` with clean, minimal styling:
- CSS variables for colors (--bg, --fg, --border, --accent)
- Dark mode support via prefers-color-scheme
- Centered container (max-width: 800px, margin: 0 auto)
- Full-width textareas with monospace font
- Responsive controls (flex-wrap for mobile)
- Button styles with hover states
- Subtle shadows and rounded corners
- Focus states for accessibility

Keep styling minimal and functional - this is a utility tool, not a marketing page.
  </action>
  <verify>
`cat src/web/index.html` shows the HTML structure
`cat src/web/style.css` shows the CSS
`wc -l src/web/style.css` shows at least 50 lines
  </verify>
  <done>Web UI HTML and CSS created with responsive layout and dark mode support</done>
</task>

<task type="auto">
  <name>Task 2: Create web UI JavaScript logic</name>
  <files>src/web/main.ts</files>
  <action>
Create `src/web/main.ts` with:

1. Import converters from browser-converters.ts:
```typescript
import { htmlToMarkdown, markdownToHtml, extractContent } from './browser-converters.js';
```

2. Get DOM elements with proper typing:
```typescript
const form = document.getElementById('converter-form') as HTMLFormElement;
const inputEl = document.getElementById('input') as HTMLTextAreaElement;
const outputEl = document.getElementById('output') as HTMLTextAreaElement;
const modeEl = document.getElementById('mode') as HTMLSelectElement;
const extractEl = document.getElementById('extract-content') as HTMLInputElement;
const copyBtn = document.getElementById('copy-btn') as HTMLButtonElement;
```

3. Form submit handler:
- Prevent default form submission
- Get input value and mode
- If mode is 'html-to-md':
  - If extract-content is checked, run extractContent() first, use result.content or show error
  - Convert HTML to Markdown
- If mode is 'md-to-html':
  - Convert Markdown to HTML (disable extract-content for this mode)
- Set output value
- Handle errors with try/catch, show error in output

4. Copy button handler:
- Use navigator.clipboard.writeText(outputEl.value)
- Provide visual feedback (briefly change button text to "Copied!")
- Handle errors gracefully

5. Mode change handler:
- Disable extract-content checkbox when mode is 'md-to-html' (extraction only makes sense for HTML input)
- Enable when mode is 'html-to-md'

6. Add event listeners for form submit, copy click, mode change

Keep the code simple and readable. No frameworks needed.
  </action>
  <verify>
`cat src/web/main.ts` shows the TypeScript code
`grep -c "addEventListener" src/web/main.ts` shows at least 3 event listeners
`grep "htmlToMarkdown\|markdownToHtml\|extractContent" src/web/main.ts` shows converter usage
  </verify>
  <done>Web UI JavaScript logic handles conversion, extraction, and clipboard operations</done>
</task>

<task type="auto">
  <name>Task 3: Create GitHub Actions deployment workflow</name>
  <files>.github/workflows/deploy-pages.yml</files>
  <action>
Create `.github/workflows/deploy-pages.yml` based on research:

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [main]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: pages
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm
      - run: npm ci
      - run: npm run build:web
      - uses: actions/upload-pages-artifact@v3
        with:
          path: docs

  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - uses: actions/deploy-pages@v4
        id: deployment
```

This workflow:
- Triggers on push to main or manual dispatch
- Builds the web UI with `npm run build:web`
- Uploads docs/ directory as artifact
- Deploys to GitHub Pages

Note: User will need to enable GitHub Pages in repo settings (Settings > Pages > Source: GitHub Actions).
  </action>
  <verify>
`cat .github/workflows/deploy-pages.yml` shows the workflow
`grep "build:web" .github/workflows/deploy-pages.yml` shows the build step
`grep "deploy-pages" .github/workflows/deploy-pages.yml` shows the deploy action
  </verify>
  <done>GitHub Actions workflow created for automated deployment on push to main</done>
</task>

<task type="auto">
  <name>Task 4: Build and verify web UI locally</name>
  <files>docs/</files>
  <action>
Build the web UI and verify it works:

1. Run `npm run build:web` to build the production bundle
2. Verify output in docs/ directory:
   - index.html exists
   - assets/ directory contains JS and CSS bundles
3. Serve locally to test: `npx serve docs` (or use python -m http.server in docs/)
4. Note the local URL for human verification

The build should complete without errors. If there are import/bundling issues, fix them before proceeding.
  </action>
  <verify>
`npm run build:web` completes successfully (exit code 0)
`ls docs/` shows index.html and assets/
`ls docs/assets/` shows bundled JS and CSS files
  </verify>
  <done>Web UI builds successfully, docs/ directory contains production bundle</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete markshift web UI with:
- HTML to Markdown conversion
- Markdown to HTML conversion
- Content extraction option for cleaning web pages
- Copy to clipboard functionality
- Dark mode support
- GitHub Actions deployment workflow
  </what-built>
  <how-to-verify>
1. Start local server: `cd /home/flight/develop/markshift && npx serve docs`
2. Open the URL shown (typically http://localhost:3000)
3. Test HTML to Markdown:
   - Paste: `<h1>Test</h1><p>Hello <strong>world</strong></p>`
   - Click Convert
   - Verify output: `# Test\n\nHello **world**`
4. Test Markdown to HTML:
   - Select "Markdown to HTML" mode
   - Paste: `# Test\n\nHello **world**`
   - Click Convert
   - Verify output contains `<h1>Test</h1>`
5. Test content extraction:
   - Select "HTML to Markdown" mode
   - Check "Extract main content"
   - Paste a full web page HTML (copy from view-source of any article)
   - Click Convert
   - Verify it extracts just the article content
6. Test copy button:
   - Click "Copy to Clipboard"
   - Paste somewhere to verify content was copied
7. Test dark mode:
   - Toggle system dark mode (or use browser devtools)
   - Verify colors adjust appropriately
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
After all tasks complete:
1. `npm run build:web` succeeds
2. `ls docs/` shows built files
3. `.github/workflows/deploy-pages.yml` exists
4. Human verified UI works correctly in browser
</verification>

<success_criteria>
- Web UI accessible at local dev server
- HTML to Markdown conversion works in browser
- Markdown to HTML conversion works in browser
- Content extraction cleans web page HTML
- Copy button copies output to clipboard
- GitHub Actions workflow ready for deployment
- Build produces optimized bundle in docs/
</success_criteria>

<output>
After completion, create `.planning/phases/10-github-pages-web-ui/10-02-SUMMARY.md`
</output>
